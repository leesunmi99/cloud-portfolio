# 🚀 CI/CD 파이프라인 구성 시 고려사항

---

## 🧩 Jenkins Pipeline 구성 여부

기존에는 각 단계를 별도의 파이프라인으로 실행했지만, Jenkins Pipeline을 사용하면 전체 단계를 연결해 자동화된 흐름을 구성할 수 있습니다.

- 일반적으로는 한번에 구성하는 것이 기능적 측면에서 효율적
- 그러나 실무에서는 **역할 분리 및 관리 책임**을 고려해 분리 구성 선호
- 트리거 설정 시, 자동 배포는 동일하게 가능
- 예시:
  - 소스 빌드: 개발자 담당
  - 컨테이너 빌드 및 배포: DevOps 엔지니어 담당

✅ **기능적 vs 관리적 관점에서 판단 필요**

---

## ⚙️ ArgoCD 구성 전략

### 1:N 구조
- **장점**: 편의성
- **단점**: 개발 환경 장애 발생 시 운영 환경 배포도 불가

### 1:1 구조
- **장점**: 장애 격리 가능
- **단점**: ArgoCD 이중 관리 부담

➡️ 실무에서는 **1:1 구조를 더 많이 사용**  
➡️ 회사의 관리 스타일 & 장애 허용 범위에 따라 선택

---

## 🛠️ CI/CD 툴 종류

| 유형 | 온라인 | 오프라인 |
|------|--------|----------|
| CI 전용 | GitHub Actions, Travis CI, CircleCI | Jenkins, JenkinsX, Tekton, GitLab |
| CD 전용 | - | ArgoCD, Spinnaker |

- 금융/의료/공공기관: 인터넷 연결 불가 → 오프라인 툴 사용
- 도입 시: **레퍼런스 많고, 유지보수 쉬운 툴 선택**
- 국내: GitHub Actions < Jenkins

---

## 🐳 Docker의 대체 가능성

### Docker 단점
1. 무겁다 (자원 사용량 높음)
2. Daemon 의존 (죽으면 전체 컨테이너 다운)

- CI/CD 서버에서는 컨테이너 실행이 목적이 아니므로 Docker 문제 없음

### 대체 툴 조합
- `buildah` : Deamonless 빌드
- `podman` : 이미지 관리
- `skopeo` : 이미지 복사/푸시

➡️ Openshift 등 관리형 Kubernetes에서 사용

---

## 🚦 배포 전략 비교

### 1. Recreate

- 작업: Deployment 업데이트
- 특징: 기존 종료 후 새 버전 배포
- 단점: **서비스 중단 발생**

---

### 2. RollingUpdate

- 작업: Deployment 순차 업데이트
- 특징: 무중단 배포 가능
- ⚠️ 단점: 구성 복잡, 트래픽 분산 실패 시 문제 발생

---

### 3. Blue/Green

- 작업:
  1. v2 Deployment 생성
  2. Service selector → v2
  3. v1 삭제

- 특징:
  - 롤백 빠름
  - 스크립트 자동화 가능
- ⚠️ 단점: v2에 과도한 트래픽 유입 시 장애 발생

---

## 🧱 과거 VM 기반 배포 방식

기존: L4 장비 → VM1/VM2 이중화 구성

- 배포 작업:
  1. VM2 연결 해제
  2. 소스 패치 및 기동
  3. L4에서 트래픽 전환

- 전환 방식:
  - VM1 → 끊고 V2 연결: Recreate
  - V2 연결 후 VM1 해제: RollingUpdate

➡️ 현재는 Kubernetes로 네트워크 장비 건드리지 않고 Blue/Green 가능
